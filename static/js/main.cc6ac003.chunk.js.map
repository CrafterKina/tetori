{"version":3,"sources":["NavigableDialog.tsx","ImageLoader.tsx","InformationPane.tsx","Tetori.tsx","PlainTextParser.tsx","SourceSwitcher.tsx","ChangeLog.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["NavigableDialog","props","contents","pos","updatePos","useState","collapse","setCollapse","className","onClick","title","hidden","e","currentTarget","scrollTop","undefined","ImageLoader","local","useRef","url","loadImage","apply","files","current","file","reader","FileReader","addEventListener","result","this","readAsDataURL","text","ref","type","accept","value","length","placeholder","ItemTypes","TextBox","note","editNote","index","onChange","target","style","width","w","height","h","zIndex","ImageBox","draggable","backgroundSize","backgroundRepeat","backgroundImage","Box","isTextNote","isImageNote","Error","DraggableBox","remove","useDrag","item","x","y","id","drag","timeout","left","top","onResize","size","clearTimeout","setTimeout","doNothing","InformationPane","notes","map","n","i","bind","key","NotePalette","createNote","image","Image","src","onload","naturalWidth","naturalHeight","generateUUID","chars","split","len","Math","floor","random","toString","join","InformationPaneEditor","pane","editPane","useCallback","concat","Object","assign","idx","p","replace","slice","append","splice","removeNote","useDrop","drop","monitor","getDifferenceFromInitialOffset","dx","dy","round","Tetori","panes","pages","dispatchEditMessage","reduce","message","args","partial","page","newPages","snapshot","newPane","edit","setEdit","checked","backgroundPosition","DndProvider","backend","HTML5Backend","values","c","dialog","PlainTextParser","blanks","lines","allowEmpty","allowEmptyLine","state","setState","parseInt","paramsObj","splitPlainText","chunk","s","replaceAll","flatMap","num","RegExp","blanksToSplit","ret","push","linesToSplit","filter","test","SourceSwitcher","source","setSource","onSourceChanged","event","t","Source","JsonTetoriDecoder","JSON","parse","ChangeLog","log","dispatchJumpMessage","to","App","useReducer","action","stepNumber","history","dispatchMessage","reportWebVitals","onPerfEntry","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.cc6ac003.chunk.js","sourcesContent":["import React, {useState} from \"react\";\n\n\ntype Props = {\n    contents: string[]\n    pos: number\n    updatePos(message: string, args: { pos: number }): void\n}\n\nexport function NavigableDialog(props: Props) {\n    const {contents, pos, updatePos} = props;\n    const [collapse, setCollapse] = useState(true);\n\n    return (<div className={\"dialog\"}>\n        <button onClick={() => setCollapse(!collapse)}>{`Prev ${collapse ? \"▲\" : \"▼\"}`}</button>\n        <p className={\"previous-dialog\"} title={\"クリックで前へ\"} hidden={collapse}\n           onClick={(e) => {\n               e.currentTarget.scrollTop = 0\n               if (contents[pos - 1] !== undefined) updatePos(`ページ${pos - 1}`, {pos: pos - 1});\n           }}>{contents[pos - 1] ?? \"NA\"}</p>\n        <p className={\"next-dialog\"} title={\"クリックで次へ\"}\n           onClick={(e) => {\n               e.currentTarget.scrollTop = 0\n               if (contents[pos + 1] !== undefined) updatePos(`ページ${pos + 1}`, {pos: pos + 1});\n           }}>{contents[pos] ?? \"NA\"}</p>\n    </div>)\n}","import React, {useRef} from \"react\";\n\nexport function ImageLoader(props: { apply(url: string): void, text: string }) {\n    const local = useRef<HTMLInputElement | null>(null);\n    const url = useRef<HTMLInputElement | null>(null);\n\n    function loadLocalImage() {\n        const files = local.current?.files;\n        if (!files) return;\n        const file = files[0];\n        if (!file) return;\n        const reader = new FileReader();\n        reader.addEventListener(\"load\", function () {\n            const result = this.result;\n            if (typeof result === \"string\") {\n                loadImage(result);\n            }\n        })\n        reader.readAsDataURL(file);\n    }\n\n    function loadImage(url: string) {\n        if (!url) return;\n        props.apply(url);\n    }\n\n    return <ul>\n        <li>\n            <label>\n                <button onClick={loadLocalImage}>{props.text}</button>\n                <input ref={local} type={\"file\"} accept={\"image/png,image/jpeg\"}/>\n            </label>\n        </li>\n        <li>\n            <label>\n                <button onClick={() => {\n                    const value = url.current?.value;\n                    if (!value || value.length === 0) return;\n                    loadImage(value)\n                }}>{props.text}</button>\n                <input ref={url} type={\"text\"} placeholder={\"https://...\"}/>\n            </label>\n        </li>\n    </ul>\n}","import ResizeObserver from 'rc-resize-observer';\nimport React, {useCallback, useRef, useState} from \"react\";\nimport {useDrag, useDrop} from \"react-dnd\";\nimport {ImageLoader} from \"./ImageLoader\";\n\ninterface Note {\n    type: typeof ItemTypes[keyof typeof ItemTypes],\n    key: string,\n    y: number,\n    x: number,\n    h?: number,\n    w?: number,\n}\n\ninterface TextNote extends Note {\n    type: \"text\"\n    h: number,\n    w: number,\n    text: string\n}\n\nfunction isTextNote(note: Note): note is TextNote {\n    return note.type === \"text\";\n}\n\ninterface ImageNote extends Note {\n    type: \"image\"\n    url: string\n}\n\nfunction isImageNote(note: Note): note is ImageNote {\n    return note.type === \"image\";\n}\n\ntype NotePacket = {\n    type: typeof ItemTypes[keyof typeof ItemTypes]\n    id: number,\n    y: number, x: number\n}\n\nexport type NoteMap = Array<Note>\n\nconst ItemTypes = {\n    TEXT: \"text\",\n    IMAGE: \"image\"\n} as const\n\ntype EditNoteFunction = (p: Partial<Omit<Note, \"key\">>) => void\n\ntype BoxType<T extends Note> = {\n    note: T,\n    editNote: EditNoteFunction,\n    index: number\n}\n\nfunction TextBox(props: BoxType<TextNote>) {\n    const {note, editNote, index} = props;\n    return <textarea\n        value={note.text}\n        onChange={(e) => editNote({text: e.target.value} as TextNote)}\n        className={\"box\"}\n        style={{\n            width: note.w,\n            height: note.h,\n            zIndex: index\n        }}/>;\n}\n\nfunction ImageBox(props: BoxType<ImageNote>) {\n    const {note, index} = props;\n    return <div className={\"box\"} draggable={false} style={{\n        width: note.w,\n        height: note.h,\n        zIndex: index,\n        backgroundSize: \"contain\",\n        backgroundRepeat: \"no-repeat\",\n        backgroundImage: `url(${note.url})`\n    }}>\n    </div>;\n}\n\nfunction Box(props: BoxType<Note>) {\n    const {editNote, index, note} = props;\n    if (isTextNote(note)) return (<TextBox note={note} editNote={editNote} index={index}/>)\n    if (isImageNote(note)) return (<ImageBox note={note} editNote={editNote} index={index}/>)\n    throw new Error();\n}\n\nfunction DraggableBox(props: { note: Note, index: number, remove(): void, editNote: EditNoteFunction }) {\n    const {note, index, remove, editNote} = props;\n    const [, drag] = useDrag<NotePacket, unknown, unknown>({\n        item: {x: note.x, y: note.y, id: index, type: ItemTypes.TEXT}\n    })\n\n    const timeout = useRef<ReturnType<typeof setTimeout>>();\n\n    return (<div className={\"draggable-wrapper\"} style={{\n        left: note.x,\n        top: note.y,\n    }}>\n        <div className={\"note-navigation\"}>\n            <div ref={drag} className={\"drag-handle\"} title={\"ドラッグで動かす\"}/>\n            <button className={\"close-button\"} onClick={remove} title={\"閉じる\"}/>\n        </div>\n        <ResizeObserver onResize={((size) => {\n            if (note.h === size.height && note.w === size.width) return;\n            if (timeout.current) clearTimeout(timeout.current);\n            timeout.current = setTimeout(() => {\n                editNote({h: size.height, w: size.width});\n            }, 1000);\n        })}>\n            <Box note={note} editNote={editNote} index={index}/>\n        </ResizeObserver>\n    </div>)\n}\n\nconst doNothing = (() => {\n});\n\nexport function InformationPane(props: { notes: Note[], remove?: (idx: number) => void, editNote?: (idx: number, p: Partial<Omit<Note, \"key\">>) => void }) {\n    const remove = props.remove ?? doNothing\n    const editNote = props.editNote ?? doNothing\n    return (\n        <div className={\"pane\"}>\n            {props.notes.map((n, i) => <DraggableBox index={i} key={n.key} note={n} remove={() => remove(i)}\n                                                     editNote={editNote.bind(undefined, i)}/>)}\n        </div>)\n}\n\nfunction NotePalette(props: { createNote(note: Omit<Note, \"key\">): void }) {\n    const [collapse, setCollapse] = useState(false);\n\n    return (<aside className={\"palette\"}>\n        <button onClick={() => setCollapse(!collapse)}>{`${collapse ? \"開く\" : \"最小化\"}`}</button>\n        <h1>パレット</h1>\n        <ul hidden={collapse}>\n            <li onClick={() => props.createNote({\n                type: \"text\",\n                text: \"\",\n                x: 0,\n                y: 0,\n                w: 300,\n                h: 300\n            } as TextNote)}>{\"テキスト\"}</li>\n            <li><ImageLoader text={\"画像\"} apply={(url) => {\n                const image = new Image();\n                image.src = url;\n                image.onload = function () {\n                    let width = image.naturalWidth;\n                    let height = image.naturalHeight;\n                    if (width <= height) {\n                        if (500 < height) {\n                            width = 500 * width / height;\n                            height = 500;\n                        }\n                    } else {\n                        if (500 < width) {\n                            height = 500 * height / width;\n                            width = 500;\n                        }\n                    }\n                    props.createNote({\n                        type: \"image\",\n                        url: url,\n                        x: 0,\n                        y: 0,\n                        h: height,\n                        w: width\n                    } as ImageNote)\n                }\n            }}/></li>\n        </ul>\n    </aside>)\n}\n\nfunction generateUUID(): string {\n    // https://qiita.com/psn/items/d7ac5bdb5b5633bae165\n    // https://github.com/GoogleChrome/chrome-platform-analytics/blob/master/src/internal/identifier.js\n    // const FORMAT: string = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\";\n    let chars = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".split(\"\");\n    for (let i = 0, len = chars.length; i < len; i++) {\n        switch (chars[i]) {\n            case 'x':\n                chars[i] = Math.floor(Math.random() * 16).toString(16);\n                break;\n            case 'y':\n                chars[i] = (Math.floor(Math.random() * 4) + 8).toString(16);\n                break;\n        }\n    }\n    return chars.join(\"\");\n}\n\nexport function InformationPaneEditor(props: { editPane(pane: NoteMap): void, pane: NoteMap }) {\n    const {pane, editPane} = props;\n\n    const createNote = useCallback((note: Partial<Note> & Omit<Note, \"key\">) => {\n        editPane(pane.concat([Object.assign({}, note, {key: generateUUID()})]))\n    }, [editPane, pane]);\n\n    const editNote = useCallback((idx: number, p: Partial<Omit<Note, \"key\">>) => {\n        const replace = pane.slice();\n        const append = Object.assign({}, replace.splice(idx, 1)[0], p)\n        editPane(replace.concat([append]))\n    }, [editPane, pane]);\n\n    const removeNote = useCallback((idx: number) => {\n        const replace = pane.slice();\n        replace.splice(idx, 1);\n        editPane(replace);\n    }, [editPane, pane])\n\n    const [, drop] = useDrop({\n        accept: [ItemTypes.TEXT],\n        drop(item: NotePacket, monitor) {\n            const {id, x, y} = item;\n            const {x: dx, y: dy} = monitor.getDifferenceFromInitialOffset() || {x: 0, y: 0};\n            const left = Math.round(x + dx);\n            const top = Math.round(y + dy);\n            editNote(id, {x: left, y: top});\n            return undefined;\n        }\n    })\n\n    return (<div className={\"pane-editor\"} ref={drop}>\n        <InformationPane notes={pane} remove={removeNote} editNote={editNote}/>\n        <NotePalette createNote={createNote}/>\n    </div>)\n}","import React, {Dispatch, useCallback, useState} from \"react\";\nimport {NavigableDialog} from \"./NavigableDialog\";\nimport {InformationPane, InformationPaneEditor, NoteMap} from \"./InformationPane\";\nimport {DndProvider} from \"react-dnd\";\nimport {HTML5Backend} from \"react-dnd-html5-backend\";\nimport \"./tetori.css\"\nimport {EditMessage} from \"./App\";\nimport {ImageLoader} from \"./ImageLoader\";\n\nexport interface Page {\n    pane?: number\n    dialog: string\n    backgroundImage?: string\n}\n\nexport type Pages = Array<Page>\nexport type Panes = Array<NoteMap>\nexport type Snapshot = { pos: number, pages: Pages, panes: Panes }\n\nexport const EmptySnapshot = (): Snapshot => ({pos: 0, pages: [], panes: [[]]})\n\ntype Props = {\n    dispatchEditMessage: Dispatch<EditMessage>\n} & Snapshot\n\nexport function Tetori(props: Props) {\n    const {panes, pages, dispatchEditMessage, pos} = props;\n\n    const reduce = useCallback((message: string, args: { page?: Partial<Page>, pane?: NoteMap, pos?: number }) => {\n        const {pos: p, pane, page: partial} = args;\n        const page = Object.assign({}, pages[pos], partial);\n        const newPages = pages.slice();\n        newPages[pos] = page;\n        dispatchEditMessage({\n            type: \"edit\",\n            message,\n            snapshot: {pages: newPages, panes: pane ? panes.concat([pane]) : panes, pos: p ?? pos}\n        });\n    }, [dispatchEditMessage, pages, panes, pos]);\n\n    const editPane = useCallback(\n        // 編集履歴のような機構をEditorが知る必要はない (このメソッドはpanes.lengthに依存)\n        (newPane: NoteMap) => reduce(\"Paneの編集\", {page: {pane: panes.length}, pane: newPane}),\n        [panes.length, reduce]\n    );\n\n    const [edit, setEdit] = useState(true);\n\n    return (<div>\n        <label><input type={\"checkbox\"} checked={edit} onChange={e => setEdit(e.target.checked)}/>編集モード</label>\n        <ImageLoader apply={(url) => {\n            reduce(\"背景画像を設定\", {page: {backgroundImage: url}})\n        }} text={\"背景画像\"}/>\n        <div className={`tetori ${edit ? \"edit\" : \"\"}`} style={pages[pos]?.backgroundImage ? {\n            backgroundImage: `url(${pages[pos]?.backgroundImage})`,\n            backgroundRepeat: \"no-repeat\",\n            backgroundPosition: \"center\",\n            backgroundSize: \"contain\"\n        } : {}}>\n            <DndProvider backend={HTML5Backend}>\n                {edit\n                    ? <InformationPaneEditor pane={panes[pages[pos]?.pane ?? panes.length - 1]} editPane={editPane}/>\n                    : <InformationPane notes={Object.values(panes[pages[pos]?.pane ?? panes.length - 1])}/>}\n            </DndProvider>\n            <NavigableDialog contents={pages.map(c => c.dialog)} pos={pos}\n                             updatePos={reduce}/>\n        </div>\n    </div>)\n}","import {EmptySnapshot, Pages} from \"./Tetori\";\nimport React, {Dispatch, useState} from \"react\";\nimport {EditMessage} from \"./App\";\n\ntype PlainTextParsing = { text: string, blanks: number, lines: number, allowEmpty: boolean, allowEmptyLine: boolean };\n\nexport function PlainTextParser(props: { dispatchEditMessage: Dispatch<EditMessage> }) {\n    const {dispatchEditMessage} = props\n    const [state, setState] = useState<PlainTextParsing>({\n        text: \"\",\n        blanks: 1,\n        lines: 0,\n        allowEmpty: false,\n        allowEmptyLine: false\n    });\n\n\n    return (\n        <div>\n            <div>\n                <label>\n                    <input type={\"number\"}\n                           value={(state.blanks || 0).toString()}\n                           onChange={(e) => {\n                               setState(Object.assign({}, state, {blanks: parseInt(e.target.value)}));\n                           }}/>\n                    {\"連続空行で段落とみなす\"}\n                </label>\n                <label>\n                    <input type={\"number\"}\n                           value={(state.lines || 0).toString()}\n                           onChange={(e) => {\n                               setState(Object.assign({}, state, {lines: parseInt(e.target.value)}));\n                           }}/>\n                    {\"複数行を段落とみなす\"}\n                </label>\n                <label>\n                    <input type={\"checkbox\"}\n                           checked={state.allowEmpty}\n                           onChange={(e) => {\n                               setState(Object.assign({}, state, {allowEmpty: e.target.checked}));\n                           }}/>\n                    {\"空の要素を許容する\"}\n                </label>\n                <label>\n                    <input type={\"checkbox\"}\n                           checked={state.allowEmptyLine}\n                           onChange={(e) => {\n                               setState(Object.assign({}, state, {allowEmptyLine: e.target.checked}));\n                           }}/>\n                    {\"空行を許容する\"}\n                </label>\n            </div>\n            <textarea value={state.text}\n                      onChange={(e) => {\n                          setState(Object.assign({}, state, {text: e.target.value}));\n                      }}/>\n            <button onClick={() => dispatchEditMessage({\n                type: \"edit\",\n                snapshot: Object.assign(EmptySnapshot(), {pages: parsePlainText(state)}),\n                message: `プレーンテキストから読み込み 空行数: ${state.blanks}, 行数: ${state.lines}, 空要素許容: ${state.allowEmpty}, 空行許容: ${state.allowEmptyLine}, テキスト: ${state.text.slice(0, 20)}`\n            })}>{\"読み込み\"}</button>\n        </div>\n    )\n}\n\nexport function splitPlainText(paramsObj: PlainTextParsing): string[] {\n    const {text, blanks, lines, allowEmpty, allowEmptyLine} = paramsObj;\n\n    function blanksToSplit(text: string, num: number): string[] {\n        return text.split(RegExp(\"\\n{\" + (num + 1) + \",}\"));\n    }\n\n    function linesToSplit(text: string, num: number): string[] {\n        const ret = [];\n        const lines = text.split(\"\\n\");\n        for (let i = 0; i < lines.length; i += num) {\n            ret.push(lines.slice(i, i + num).join(\"\\n\"));\n        }\n        return ret;\n    }\n\n    let chunk = [text];\n    // 空白しかない行を空行とみなすために前処理。\\sだと\\nが含まれてしまうため個別に指定している\n    chunk = chunk.map(s => s.replaceAll(/^[\\f\\r\\t\\v\\u00a0\\u1680\\u180e\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000\\ufeff]+$/gm, \"\"));\n    if (blanks > 0) chunk = chunk.flatMap(s => blanksToSplit(s, blanks));\n    if (!allowEmptyLine) chunk = chunk.map(s => s.replaceAll(/^\\n/gm, \"\").replaceAll(/\\n$/g, \"\"));\n    if (lines > 0) chunk = chunk.flatMap(s => linesToSplit(s, lines));\n    if (!allowEmpty) chunk = chunk.filter(e => e.length !== 0 && !/^\\s*$/.test(e));\n    return chunk;\n}\n\nfunction parsePlainText(paramsObj: PlainTextParsing): Pages {\n    return splitPlainText(paramsObj).map(e => ({dialog: e}));\n}","import React, {ChangeEvent, Dispatch, useState} from \"react\";\nimport {PlainTextParser} from \"./PlainTextParser\";\nimport {EditMessage} from \"./App\";\n\nexport function SourceSwitcher(props: { dispatchEditMessage: Dispatch<EditMessage> }) {\n    const {dispatchEditMessage} = props;\n    const [source, setSource] = useState<SourceType>(\"plain_text\");\n\n    function onSourceChanged(event: ChangeEvent<HTMLInputElement>) {\n        if (!isSourceType(event.target.value)) return;\n        if (!event.target.checked) return;\n        setSource(event.target.value);\n    }\n\n    return (<div>\n        <div hidden={true}>\n            <label>\n                <input type={\"radio\"} checked={source === \"plain_text\"} onChange={onSourceChanged}\n                       value={\"plain_text\"}/> {\"PlainText\"}\n            </label>\n            <label>\n                <input type={\"radio\"} checked={source === \"json\"} onChange={onSourceChanged} value={\"json\"}/> {\"JSON\"}\n            </label>\n        </div>\n        <Source type={source} dispatchEditMessage={dispatchEditMessage}/>\n    </div>)\n}\n\ntype SourceType = \"plain_text\" | \"json\"\n\nfunction isSourceType(t: string): t is SourceType {\n    return t === \"plain_text\" || t === \"json\";\n\n}\n\ntype SourceProps = {\n    type: SourceType,\n    dispatchEditMessage: Dispatch<EditMessage>\n}\n\nfunction Source(props: SourceProps) {\n    switch (props.type) {\n        case \"plain_text\":\n            return (<PlainTextParser dispatchEditMessage={props.dispatchEditMessage}/>)\n        case \"json\":\n            return (<JsonTetoriDecoder dispatchEditMessage={props.dispatchEditMessage}/>)\n        default:\n            throw new Error();\n    }\n}\n\nfunction JsonTetoriDecoder(props: { dispatchEditMessage: Dispatch<EditMessage> }) {\n    return (<textarea onChange={(event) => {\n        try {\n            props.dispatchEditMessage({type: \"edit\", snapshot: JSON.parse(event.target.value), message: \"JSONからのロード\"})\n        } catch (e: unknown) {\n            // todo error handling\n        }\n    }}/>)\n}\n\n","import React, {Dispatch} from \"react\";\nimport {JumpMessage} from \"./App\";\n\nexport function ChangeLog(props: { dispatchJumpMessage: Dispatch<JumpMessage>, log: string[] }) {\n    return (<aside>\n        <h1>編集履歴</h1>\n        <ol className={\"changelog\"}>\n            {props.log.map((e, i) => <li key={i} onClick={() => {\n                props.dispatchJumpMessage({type: \"jump\", to: i})\n            }}>{e}</li>)}\n        </ol>\n    </aside>)\n}","import \"./app.css\"\n\nimport React, {Reducer, useReducer} from 'react';\nimport {EmptySnapshot, Snapshot, Tetori} from \"./Tetori\";\nimport {SourceSwitcher} from \"./SourceSwitcher\";\nimport {ChangeLog} from \"./ChangeLog\";\n\ntype Step = { message: string, snapshot: Snapshot };\ntype History = { stepNumber: number, history: Array<Step> }\n\nexport type EditMessage = { type: \"edit\", snapshot: Snapshot, message: string };\nexport type JumpMessage = { type: \"jump\", to: number }\n\nfunction App() {\n    const [state, dispatchMessage] = useReducer<Reducer<History, EditMessage | JumpMessage>>((state, action) => {\n        switch (action.type) {\n            case \"edit\": {\n                const {message, snapshot} = action;\n                return {stepNumber: state.history.length, history: state.history.concat({message, snapshot})};\n            }\n            case \"jump\": {\n                return Object.assign({}, state, {stepNumber: action.to});\n            }\n        }\n    }, {stepNumber: 0, history: [{message: \"新規\", snapshot: EmptySnapshot()}]});\n\n    return (\n        <div className=\"App\">\n            <SourceSwitcher dispatchEditMessage={dispatchMessage}/>\n            <Tetori dispatchEditMessage={dispatchMessage}  {...state.history[state.stepNumber].snapshot} />\n            <ChangeLog dispatchJumpMessage={dispatchMessage} log={state.history.map(e => e.message)}/>\n        </div>\n    );\n}\n\nexport default App;\n","import {ReportHandler} from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry) {\n    import('web-vitals').then(({getCLS, getFID, getFCP, getLCP, getTTFB}) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import 'react-app-polyfill/stable';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport \"./reset.css\"\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App/>\n    </React.StrictMode>,\n    document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}